# 🔐 SSH访问管理工具

这个文件夹包含了管理SSH访问服务器 `kevin@90.195.120.165` 的所有工具和文档。

## ⚠️ 重要提示

**新电脑没有SSH权限时无法直接添加公钥！** 必须从**已有SSH权限的电脑**或通过**服务器控制台**来添加新电脑的公钥。

## 📁 文件说明

### 文档
- **`SSH_ACCESS_SETUP.md`** - 完整的SSH访问设置指南，包含详细步骤和故障排查
- **`SSH_QUICK_REFERENCE.md`** - 快速参考卡片，包含常用命令
- **`GET_PUBLIC_KEY.md`** - 获取新电脑SSH公钥的指南（不同操作系统）

### 脚本
- **`add-new-computer-key.sh`** - ⭐ **推荐**：从已有权限的电脑添加新电脑的公钥
- **`add-ssh-key-to-server.sh`** - 从当前电脑添加公钥（仅当当前电脑已有权限时使用）
- **`manage-ssh-keys.sh`** - 管理服务器上的所有SSH密钥

## 🚀 快速开始

### 场景1: 添加新电脑访问（新电脑没有权限）

**步骤1**: 在新电脑上生成SSH密钥并获取公钥
```bash
# 在新电脑上执行
ssh-keygen -t ed25519 -C "your-email@example.com"
cat ~/.ssh/id_ed25519.pub
# 复制公钥内容
```

**步骤2**: 从已有权限的电脑添加公钥
```bash
# 在已有权限的电脑上执行
cd ssh
./add-new-computer-key.sh
# 选择"直接粘贴公钥内容"，然后粘贴新电脑的公钥
```

**步骤3**: 在新电脑上测试连接
```bash
# 在新电脑上执行
ssh kevin@90.195.120.165
```

### 场景2: 当前电脑已有权限，添加自己的其他密钥

```bash
cd ssh
./add-ssh-key-to-server.sh
```

### 场景3: 管理所有SSH密钥

```bash
cd ssh
./manage-ssh-keys.sh
```

功能包括：
- 查看所有授权密钥
- 添加新公钥
- 删除公钥
- 备份授权密钥文件
- 检查文件权限
- 测试SSH连接

## 📚 详细文档

- **`SSH_ACCESS_SETUP.md`** - 完整的使用指南，包含所有方法和故障排查
- **`GET_PUBLIC_KEY.md`** - 在不同操作系统上获取SSH公钥的方法
- **`SSH_QUICK_REFERENCE.md`** - 快速参考命令

## 🔒 服务器信息

- **服务器地址**: `kevin@90.195.120.165`
- **SSH端口**: `22` (默认)

## 💡 使用提示

1. **新电脑没有权限时**：必须从已有权限的电脑运行 `add-new-computer-key.sh` 添加公钥
2. **每台电脑使用独立的密钥**：便于管理和撤销访问
3. **定期备份授权密钥文件**：使用 `manage-ssh-keys.sh` 脚本可以备份
4. **为公钥添加注释**：在公钥末尾添加注释来标识电脑，例如：`ssh-ed25519 AAAAC3... laptop-kevin`

## ❓ 常见问题

### Q: 新电脑没有SSH权限，怎么办？

A: 必须从**已有SSH权限的电脑**运行 `add-new-computer-key.sh` 脚本，或通过**服务器控制台**直接添加公钥。

### Q: 可以使用密码登录吗？

A: 如果服务器启用了密码认证，可以先用密码登录，然后添加公钥。但推荐使用SSH密钥，更安全。

### Q: 如何获取新电脑的公钥？

A: 查看 `GET_PUBLIC_KEY.md` 文件，包含不同操作系统的详细说明。

### Q: 如何撤销某台电脑的访问权限？

A: 使用 `manage-ssh-keys.sh` 脚本删除对应的公钥。

## 🔄 工作流程

```
新电脑 (无权限)
    ↓
1. 生成SSH密钥对
    ↓
2. 获取公钥内容
    ↓
3. 发送公钥给管理员 或 从已有权限电脑运行脚本
    ↓
已有权限的电脑
    ↓
4. 运行 add-new-computer-key.sh
    ↓
5. 添加公钥到服务器
    ↓
新电脑 (现在有权限了)
    ↓
6. 测试SSH连接
```
